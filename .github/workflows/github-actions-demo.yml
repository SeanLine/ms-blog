name: Deploy Hexo to GitHub Pages

on:
  push:
    branches:
      - main # å½“ main åˆ†æ”¯æœ‰æ¨é€æ—¶è§¦å‘

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest # ä½¿ç”¨ Ubuntu æœ€æ–°ç‰ˆæœ¬çš„ GitHub Runner

    steps:
      - run: echo "ğŸ‰ The job was automatically triggered by a ${{ secrets  }} event."
      # æ£€å‡º Hexo é¡¹ç›®çš„ä»£ç 
      - name: Checkout code
        uses: actions/checkout@v2

      # è®¾ç½® Node.js ç¯å¢ƒ
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      # å®‰è£… Hexo ä¾èµ–
      - name: Install dependencies
        run: npm install

      # ç”Ÿæˆ Hexo åšå®¢é™æ€æ–‡ä»¶
      - name: Build Hexo
        run: npm run build # Hexo çš„é»˜è®¤ç”Ÿæˆå‘½ä»¤æ˜¯ 'hexo generate'

      # éƒ¨ç½²é™æ€æ–‡ä»¶åˆ° GitHub Pages
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          deploy_key: ${{ secrets.PERSONAL_TOKEN  }}
          # github_token: ${{ secrets.GITHUB_TOKEN }} # ä½¿ç”¨ GitHub è‡ªåŠ¨ç”Ÿæˆçš„ä»¤ç‰Œ
          publish_dir: ./public # Hexo çš„ç”Ÿæˆç›®å½•æ˜¯ './public'
          publish_branch: gh-pages # éƒ¨ç½²åˆ° main åˆ†æ”¯
          external_repository: seanLine/seanline.github.io
